{% load static %}

{% include 'header.html' %}
<head>
    <link rel="stylesheet" type="text/css" href="{% static 'css/mystyle.css' %}" media="all">
    <link rel="stylesheet" type="text/css" href="{% static 'css/checkbox.css' %}" media="all">
    <script type="text/javascript" src="{% static 'input-filestyle/bootstrap-filestyle.min.js' %}"></script>

</head>

<script type="text/javascript">

$(document).ready(function(){
    $(":file").filestyle({icon: false});

    $('#vacancy_edit').click(function(){
        var company_name_C = "{{ company_name_C }}";
        var account = "{{ account }}";

        var vacancies_old = "{{ vacancies }}";
        var vacancies = document.getElementById("vacancies").value;
        var work_place = document.getElementById("work_place").value;
        var work_time = document.getElementById("work_time").value;
        var treatment = document.getElementById("treatment").value;
        var number_of_people = document.getElementById("select").value;
        var wrok_content = document.getElementById("wrok_content").value;

        var file1 = "{{ result.9 }}"
        var file2 = "{{ result.10 }}"
        var file3 = "{{ result.11 }}"

        var unit = document.getElementById("unit").value;
        var fill_in = document.getElementById("fill_in").value;
        var job_title = document.getElementById("job_title").value;
        var tel = document.getElementById("tel").value;
        var email = document.getElementById("email").value;
        var unit_post = document.getElementById("unit_post").checked;

        var publish_date_start_old = "{{ publish_date_start }}";
        var publish_date_start = document.getElementById("publish_date_start").value;
        var publish_date_end_old = "{{ publish_date_end }}";
        var publish_date_end = document.getElementById("publish_date_end").value;
        $.ajax({
            url:"{% url 'Vacancy_edit' %}",
            data :  {
                company_name_C,
                account,

                vacancies_old,
                vacancies,
                work_place,
                work_time,
                treatment,
                number_of_people,
                wrok_content,

                file1,
                file2,
                file3,
                
                unit,
                fill_in,
                job_title,
                tel,
                email,
                unit_post,

                publish_date_start_old,
                publish_date_start,
                publish_date_end_old,
                publish_date_end,
                csrfmiddlewaretoken: '{{ csrf_token }}'
            },
            type:'POST',

            datatype : 'text',
                
            success:function(data){
                window.location.href = "{% url 'Vacancy_M_admin' %}?company_name_C=" + company_name_C +"&account=" + account;
            },
                                        
            beforeSend:function(){

            },

            complete:function(){

            },        
            error:function(xhr, ajaxOptions, thrownError){ 
                alert(xhr.status); 
                alert(thrownError);
            }       
        });  
                                                                                                         
    });

    $('#vacancy_cancelpost').click(function(){
        var company_name_C = "{{ company_name_C }}";
        var account = "{{ account }}";

        var vacancies = "{{ vacancies }}";
        var publish_date_start = "{{ publish_date_start }}";
        var publish_date_end = "{{ publish_date_end }}";

        $.ajax({
            url:"{% url 'Vacancy_cancel' %}",
            data :  {
                company_name_C,
                account,
                vacancies,
                publish_date_start,
                publish_date_end,
                csrfmiddlewaretoken: '{{ csrf_token }}'
            },
            type:'POST',

            datatype : 'text',
                
            success:function(data){
                window.location.href = "{% url 'Vacancy_M_admin' %}?company_name_C=" + company_name_C +"&account=" + account;
            },
                                        
            beforeSend:function(){

            },

            complete:function(){

            },        
            error:function(xhr, ajaxOptions, thrownError){ 
                alert(xhr.status); 
                alert(thrownError);
            }       
        });  
                                                                                                         
    });

    $('#vacancy_post').click(function(){
        var company_name_C = "{{ company_name_C }}";
        var account = "{{ account }}";

        var vacancies = "{{ vacancies }}";
        var publish_date_start = "{{ publish_date_start }}";
        var publish_date_end = "{{ publish_date_end }}";

        $.ajax({
            url:"{% url 'Vacancy_post' %}",
            data :  {
                company_name_C,
                account,
                vacancies,
                publish_date_start,
                publish_date_end,
                csrfmiddlewaretoken: '{{ csrf_token }}'
            },
            type:'POST',

            datatype : 'text',
                
            success:function(data){
                window.location.href = "{% url 'Vacancy_M_admin' %}?company_name_C=" + encodeURI(company_name_C) +"&account=" + encodeURI(account);
            },
                                        
            beforeSend:function(){

            },

            complete:function(){

            },        
            error:function(xhr, ajaxOptions, thrownError){ 
                alert(xhr.status); 
                alert(thrownError);
            }       
        });  
                                                                                                         
    });

    $("#select").select2({
        placeholder: "Select a number",
        allowClear: true
    });

    function checkbox_value(checkboxname){//數checkbox2[]有勾選幾個
        var feature_value = new Array();
        $("input:checkbox:checked[name='"+checkboxname+"']").each(function(i) { 
            feature_value[i] = this.value; 
        });
        return feature_value;
    }

    $('#vacancy_edit_pre').click(function(){
        $("#modal_edit_confirm").modal('show');
    })

    $('#vacancy_edit').click(function(){
        $("#modal_edit_confirm").modal('hide');
    })

    $('#vacancy_cancelpost_pre').click(function(){
        $("#modal_cancelpost_confirm").modal('show');
    })

    $('#vacancy_cancelpost').click(function(){
        $("#modal_cancelpost_confirm").modal('hide');
    })

    $('#vacancy_post_pre').click(function(){
        $("#modal_post_confirm").modal('show');
    })

    $('#vacancy_post').click(function(){
        $("#modal_post_confirm").modal('hide');
    })

    var dateToday = new Date(); 
    $('#publish_date_start').datepicker({
        dateFormat: 'yy/mm/dd',
        numberOfMonths: 2,
        minDate: dateToday,
    });

    $('#publish_date_end').datepicker({
        dateFormat: 'yy/mm/dd',
        numberOfMonths: 2,
        minDate: dateToday
    });
});
</script>

<div id="id_content">
    <div id = "middle">
        <div width=100% align="center">
            <div id="Sidebar_middle">
	            <ul class="nav nav-tabs">
                    <li>
                        <a href="{% url 'Vacancy_edit_page_admin' %}?company_name_C={{ result.1|urlencode }}&account={{ result.2|urlencode }}&vacancies={{ result.3|urlencode }}&work_place={{ result.4|urlencode }}&work_time={{ result.5|urlencode }}&treatment={{ result.6|urlencode }}&publish_date_start={{ result.17|urlencode }}&publish_date_end={{ result.18|urlencode }}" style="background-color:#fcfcfc;border-top:2px solid #1982b8;font-weight:bold;">職缺資訊</a>
                    </li>
 
	            </ul>
	            <form class="form-horizontal SearchForm">
	                <br><br>

    	            <ul class="nav nav-tabs" style="padding-left: 70px;">
	                	<li role="presentation" class="active"><a style="background-color:#fcfcfc;border-bottom:2px solid #B22222;font-weight:bold;box-shadow:5px 5px 8px 2px #ccc;">JOB</a></li>
	            	</ul><br>
				 	<div class='FormOption'>
                        <div class="form-group">
	                            
                            <label for="inputPassword3" class="col-sm-3 control-label">* 職缺項目 : </label>

                            <div class="col-sm-6">
                                {% if result %}
                                    <input type="text" class="form-control" placeholder="" value="{{ result.3 }}" id="vacancies">
                                {% else %}
                                    <input type="text" class="form-control" placeholder="" id="vacancies">
                                {% endif %}
                            </div><br><br>

                            <label for="inputPassword3" class="col-sm-3 control-label">* 工作地點 : </label>

                            <div class="col-sm-6">
                                {% if result %}
                                    <input type="text" class="form-control" placeholder="" value="{{ result.4 }}" id="work_place">
                                {% else %}
                                    <input type="text" class="form-control" placeholder="" id="work_place">
                                {% endif %}
                            </div><br><br>

                            <label for="inputPassword3" class="col-sm-3 control-label">* 工作時間 : </label>

                            <div class="col-sm-6">
                                {% if result %}
                                    <input type="text" class="form-control" placeholder="" value="{{ result.5 }}" id="work_time">
                                {% else %}
                                    <input type="text" class="form-control" placeholder="" id="work_time">
                                {% endif %}
                            </div><br><br>

                            <label for="inputPassword3" class="col-sm-3 control-label">* 工作待遇 : </label>

                            <div class="col-sm-6">
                                {% if result %}
                                    <input type="text" class="form-control" placeholder="" value="{{ result.6 }}" id="treatment">
                                {% else %}
                                    <input type="text" class="form-control" placeholder="" id="treatment">
                                {% endif %}
                            </div><br><br>

                            <label for="inputPassword3" class="col-sm-3 control-label">* 需求人數 : </label>

                            <div class="col-sm-6">

						      	<select class="form-control" id = 'select' style='width: 100%'>
                                    {% if result %}
                                        <option value="{{ result.7 }}" selected>{{ result.7 }}</option>
                                    {% else %}
                                        <option></option>
                                    {% endif %}
                                    {% for i in option_range %}
                                        {% if i != result.7 %}
                                            <option value="{{ i }}">{{ i }}</option>
                                        {% endif %}
                                    {% endfor %}
                                    
                                </select>
                            </div><br><br>

                            <label for="inputPassword3" class="col-sm-3 control-label">* 工作內容 :<br>(含應徵方式)</label>

                            <div class="col-sm-6">
                                {% if result %}
                                    <textarea class="form-control" style="height:200px;" id="wrok_content">{{ result.8 }}</textarea>
                                {% else %}
                                    <textarea class="form-control" style="height:200px;" id="wrok_content"></textarea>
                                {% endif %}
                            </div><br>
                        </div>
                    </div><br>

                    <ul class="nav nav-tabs" style="padding-left: 70px;">
                        <li role="presentation" class="active"><a style="background-color:#fcfcfc;border-bottom:2px solid #B22222;font-weight:bold;box-shadow:5px 5px 8px 2px #ccc;">File</a></li>
                    </ul><br>
                    <div class='FormOption'>
                        <div class="form-group">
                                
                            <label for="inputPassword3" class="col-sm-3 control-label">附檔1 : </label>

                            <div class="col-sm-6">
                                <a href="{% url 'download' %}?folder=uploads1&filename={{ result.9 }}"><button type="button" class="btn btn-primary">下載</button></a>
                            </div><br><br>
                            {% if result %}
                                <label for="inputPassword3" class="col-sm-3 control-label"></label>
                                <div class="col-sm-6">
                                    {{ result.9 }}
                                </div>
                            {% endif %}<br><br>


                            <label for="inputPassword3" class="col-sm-3 control-label">附檔2 : </label>

                            <div class="col-sm-6">
                                <a href="{% url 'download' %}?folder=uploads2&filename={{ result.10 }}"><button type="button" class="btn btn-primary">下載</button></a>
                            </div><br><br>
                            {% if result %}
                                <label for="inputPassword3" class="col-sm-3 control-label"></label>
                                <div class="col-sm-6">
                                    {{ result.10 }}
                                </div>
                            {% endif %}<br><br>

                            <label for="inputPassword3" class="col-sm-3 control-label">附檔3 : </label>

                            <div class="col-sm-6">
                                <a href="{% url 'download' %}?folder=uploads3&filename={{ result.11 }}"><button type="button" class="btn btn-primary">下載</button></a>
                            </div><br><br>
                            {% if result %}
                                <label for="inputPassword3" class="col-sm-3 control-label"></label>
                                <div class="col-sm-6">
                                    {{ result.11 }}
                                </div>
                            {% endif %}<br><br>
                        </div>
                    </div><br>

                    <ul class="nav nav-tabs" style="padding-left: 70px;">
                        <li role="presentation" class="active"><a style="background-color:#fcfcfc;border-bottom:2px solid #B22222;font-weight:bold;box-shadow:5px 5px 8px 2px #ccc;">Unit</a></li>
                    </ul><br>
                    <div class='FormOption'>
                        <div class="form-group">
                                
                            <label for="inputPassword3" class="col-sm-3 control-label">* 填寫單位 : </label>

                            <div class="col-sm-6">
                                {% if result %}
                                    <input type="text" class="form-control" placeholder="" value="{{ result.12 }}" id="unit">
                                {% else %}
                                    <input type="text" class="form-control" placeholder="" id="unit">
                                {% endif %}
                            </div><br><br>

                            <label for="inputPassword3" class="col-sm-3 control-label">填寫人 : </label>

                            <div class="col-sm-6">
                                {% if result %}
                                    <input type="text" class="form-control" placeholder="" value="{{ result.13 }}" id="fill_in">
                                {% else %}
                                    <input type="text" class="form-control" placeholder="" id="fill_in">
                                {% endif %}
                            </div><br><br>

                            <label for="inputPassword3" class="col-sm-3 control-label">職稱 : </label>

                            <div class="col-sm-6">
                                {% if result %}
                                    <input type="text" class="form-control" placeholder="" value="{{ result.15 }}" id="job_title">
                                {% else %}
                                    <input type="text" class="form-control" placeholder="" id="job_title">
                                {% endif %}
                            </div><br><br>

                            <label for="inputPassword3" class="col-sm-3 control-label">連絡電話 : </label>

                            <div class="col-sm-6">
                                {% if result %}
                                    <input type="text" class="form-control" placeholder="" value="{{ result.15 }}" id="tel">
                                {% else %}
                                    <input type="text" class="form-control" placeholder="" id="tel">
                                {% endif %}
                            </div><br><br>

                            <label for="inputPassword3" class="col-sm-3 control-label">* Email : </label>

                            <div class="col-sm-6">
                                {% if result %}
                                    <input type="text" class="form-control" placeholder="" value="{{ result.16 }}" id="email">
                                {% else %}
                                    <input type="text" class="form-control" placeholder="" id="email">
                                {% endif %}
                            </div><br><br>
                            {% if result.21 == 'true' %}
                                <label for="inputPassword3" class="col-sm-3 control-label"><input id="unit_post" type="checkbox" checked></label>
                            {% else %}
                                <label for="inputPassword3" class="col-sm-3 control-label"><input id="unit_post" type="checkbox"></label>
                            {% endif %}
                            <div class="col-sm-6">
                                將此欄資訊公布在職缺列表
                            </div><br><br>
                        </div>
                    </div><br>

                    <ul class="nav nav-tabs" style="padding-left: 70px;">
                        <li role="presentation" class="active"><a style="background-color:#fcfcfc;border-bottom:2px solid #B22222;font-weight:bold;box-shadow:5px 5px 8px 2px #ccc;">職缺刊登期間</a></li>
                    </ul><br>
                    <div class='FormOption'>
                        <div class="form-group">
                                
                            <label for="inputPassword3" class="col-sm-3 control-label">* 刊登日期(起) : </label>

                            <div class="col-sm-6">
                                {% if result %}
                                    <div class="input-group">
                                        <input type='text' class="form-control" id="publish_date_start" value="{{ result.17 }}">
                                        <span class="input-group-addon">
                                            <span class="glyphicon glyphicon-calendar" aria-hidden="true"></span>
                                        </span>
                                    </div>
                                {% else %}
                                    <div class="input-group">
                                        <input type='text' class="form-control" id="publish_date_start">
                                        <span class="input-group-addon">
                                            <span class="glyphicon glyphicon-calendar" aria-hidden="true"></span>
                                        </span>
                                    </div>
                                {% endif %}
                            </div><br><br>

                            <label for="inputPassword3" class="col-sm-3 control-label">* 刊登日期(迄) : </label>

                            <div class="col-sm-6">
                                {% if result %}
                                    <div class="input-group">
                                        <input type='text' class="form-control" id="publish_date_end" value="{{ result.18 }}">
                                        <span class="input-group-addon">
                                            <span class="glyphicon glyphicon-calendar" aria-hidden="true"></span>
                                        </span>
                                    </div>
                                {% else %}
                                    <div class="input-group">
                                        <input type='text' class="form-control" id="publish_date_end">
                                        <span class="input-group-addon">
                                            <span class="glyphicon glyphicon-calendar" aria-hidden="true"></span>
                                        </span>
                                    </div>
                                {% endif %}
                            </div><br><br>
                        </div>
                    </div><br>
                    <button type ='button' value = 'search' id = "vacancy_edit_pre" class="btn btn-primary">儲存/修改資料</button><br><br>

                    <button type ='button' value = 'search' id = "vacancy_post_pre" class="btn btn-primary">進行刊登</button>
                    <button type ='button' value = 'search' id = "vacancy_cancelpost_pre" class="btn btn-primary">取消刊登</button><br><br>
	            </form><br>

                <div class="modal fade" id="modal_edit_confirm" role="dialog">
                    <div class="modal-dialog">
                      <!-- Modal content-->
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                                <h4 class="modal-title">請再次確認!</h4>
                            </div>
                        <div class="modal-body">
                            <p>儲存修改資料?</p>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" id="vacancy_edit">確認</button>
                            <button type="button" class="btn btn-default" data-dismiss="modal">關閉</button>
                        </div>
                        </div>
                    </div>
                </div>

                <div class="modal fade" id="modal_post_confirm" role="dialog">
                    <div class="modal-dialog">
                      <!-- Modal content-->
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                                <h4 class="modal-title">請再次確認!</h4>
                            </div>
                        <div class="modal-body">
                            <p>進行刊登?</p>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" id="vacancy_post">確認</button>
                            <button type="button" class="btn btn-default" data-dismiss="modal">關閉</button>
                        </div>
                        </div>
                    </div>
                </div>

                <div class="modal fade" id="modal_cancelpost_confirm" role="dialog">
                    <div class="modal-dialog">
                      <!-- Modal content-->
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                                <h4 class="modal-title">請再次確認!</h4>
                            </div>
                        <div class="modal-body">
                            <p>取消刊登?</p>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" id="vacancy_cancelpost">確認</button>
                            <button type="button" class="btn btn-default" data-dismiss="modal">關閉</button>
                        </div>
                        </div>
                    </div>
                </div>

           	</div>
        </div>

        <div id = 'output'>
        </div>
    </div>
</div><br>


{% include 'footer.html' %}
